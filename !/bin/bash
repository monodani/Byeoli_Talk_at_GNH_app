#!/bin/bash
# check_files.sh - ë²¡í„°ìŠ¤í† ì–´ íŒŒì¼ í™•ì¸ ìŠ¤í¬ë¦½íŠ¸

echo "ğŸ” ë²¡í„°ìŠ¤í† ì–´ íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸"
echo "================================"

# ë²¡í„°ìŠ¤í† ì–´ ë””ë ‰í† ë¦¬ í™•ì¸
if [ -d "vectorstores" ]; then
    echo "âœ… vectorstores ë””ë ‰í† ë¦¬ ì¡´ì¬"
    echo "ğŸ“Š ì „ì²´ í¬ê¸°: $(du -sh vectorstores | cut -f1)"
    echo ""
    
    # ê° ë„ë©”ì¸ë³„ í™•ì¸
    for domain in satisfaction general publish cyber menu notice; do
        echo "ğŸ¯ $domain ë„ë©”ì¸:"
        
        if [ "$domain" = "satisfaction" ]; then
            dir_path="vectorstores/vectorstore_unified_satisfaction"
        elif [ "$domain" = "publish" ]; then
            dir_path="vectorstores/vectorstore_unified_publish"
        else
            dir_path="vectorstores/vectorstore_$domain"
        fi
        
        if [ -d "$dir_path" ]; then
            echo "  ğŸ“‚ ë””ë ‰í† ë¦¬: âœ…"
            
            faiss_file="$dir_path/${domain}_index.faiss"
            pkl_file="$dir_path/${domain}_index.pkl"
            bm25_file="$dir_path/${domain}_index.bm25"
            
            [ -f "$faiss_file" ] && echo "  ğŸ“„ FAISS: âœ… ($(stat -f%z "$faiss_file" 2>/dev/null | numfmt --to=iec || stat -c%s "$faiss_file" | numfmt --to=iec))" || echo "  ğŸ“„ FAISS: âŒ"
            [ -f "$pkl_file" ] && echo "  ğŸ“„ PKL: âœ… ($(stat -f%z "$pkl_file" 2>/dev/null | numfmt --to=iec || stat -c%s "$pkl_file" | numfmt --to=iec))" || echo "  ğŸ“„ PKL: âŒ"
            [ -f "$bm25_file" ] && echo "  ğŸ“„ BM25: âœ… ($(stat -f%z "$bm25_file" 2>/dev/null | numfmt --to=iec || stat -c%s "$bm25_file" | numfmt --to=iec))" || echo "  ğŸ“„ BM25: âŒ"
        else
            echo "  ğŸ“‚ ë””ë ‰í† ë¦¬: âŒ"
        fi
        echo ""
    done
else
    echo "âŒ vectorstores ë””ë ‰í† ë¦¬ ì—†ìŒ"
    echo "ğŸ’¡ í•´ê²°ë°©ë²•: make build-index-all ì‹¤í–‰"
fi

echo "================================"
echo "ğŸ”§ ë¬¸ì œ í•´ê²° ë°©ë²•:"
echo "1. ì „ì²´ ì¸ë±ìŠ¤ ë¹Œë“œ: make build-index-all"
echo "2. ë°ì´í„° í™•ì¸: ls -la data/"
echo "3. ê¶Œí•œ í™•ì¸: ls -la vectorstores/"
