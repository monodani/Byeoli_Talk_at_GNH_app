# ================================================================
# BYEOLI_TALK_AT_GNHRD_app - requirements.txt (OpenAI 호환성 수정)
# 벼리톡@경상남도인재개발원(경상남도인재개발원 RAG 챗봇)
# ================================================================

# --- 🔧 Core Framework & Configuration ---
python-dotenv==1.0.1          # .env 파일 로드
pydantic==2.5.0               # 데이터 검증 및 타입 체크 (contracts.py)
structlog==24.4.0             # 구조화된 로깅

# --- 📊 Data Processing & Analysis ---
pandas==2.2.2                 # CSV 데이터 처리 (만족도 조사, 연락처)
numpy==1.26.4                 # 수치 연산 (벡터 연산, 통계)

# --- 🔍 Search & Retrieval ---
rank-bm25==0.2.2              # BM25 키워드 검색
faiss-cpu==1.8.0.post1        # 벡터 유사도 검색 (CPU 버전)
scikit-learn==1.5.1           # MMR 및 클러스터링

# --- 📄 File Processing & Text Extraction ---
pypdf==5.1.0                  # PDF 텍스트 추출 (2025plan.pdf, 2024pyeongga.pdf)
PyPDF2==3.0.1                 # PDF 처리 보조 라이브러리  
Pillow==10.4.0                # 이미지 처리 (식단표 이미지)
pytesseract==0.3.13           # OCR 텍스트 인식
tiktoken==0.7.0               # OpenAI 토큰 계산 (청킹 최적화)
chardet==5.2.0                # 인코딩 감지 (CSV 파일)

# --- 🤖 AI & Machine Learning (최종 호환성 수정) ---
openai==1.32.0                # 더 안정적인 버전으로 다운그레이드
langchain==0.2.12             # LangChain 프레임워크
langchain-openai==0.1.17      # 더 안정적인 호환 버전
langchain-community==0.2.11   # LangChain 커뮤니티 확장

# --- 🌐 Web Framework & API ---
streamlit==1.38.0             # 웹 UI 프레임워크  
requests==2.32.3              # HTTP 요청 (OpenAI API 호출)

# --- ✅ Validation & Schema ---
jsonschema==4.21.1            # JSON 스키마 검증 (schemas/*.json)

# --- ⚡ Performance & Async ---
tenacity==8.3.0               # 재시도 로직 (API 호출 안정성)
cachetools==5.4.0             # 메모리 캐시

# --- 🔄 File Monitoring & Hotswap ---
watchdog==4.0.0               # 파일 변경 감지 (핫스왑)

# --- 📦 Serialization & Data Format ---
orjson==3.10.3                # 고성능 JSON 처리 (로그, 캐시)

# --- 📝 Text Processing & NLP ---
rapidfuzz==3.9.6              # 빠른 문자열 매칭 (엔티티 추출)

# --- 🔧 Development & Testing (개발환경만) ---
# pytest==8.3.2               # 테스트 프레임워크 (배포 시 제외)
# black==24.4.2                # 코드 포맷팅 (배포 시 제외)
# ruff==0.5.7                  # 린팅 및 포맷팅 (배포 시 제외)

# --- 🎨 Rich CLI & UI ---
rich==13.7.1                  # 콘솔 출력 향상

# --- 🔧 System & Platform ---
python-multipart==0.0.9       # 멀티파트 폼 데이터
typing-extensions==4.12.2     # 타입 힌트 확장
python-dateutil==2.9.0        # 날짜 처리

# ================================================================
# 🚨 최종 수정사항
# ================================================================
# 1. openai: 1.37.1 → 1.30.5 (proxies 오류 완전 해결)
# 2. langchain-openai: 0.1.20 → 0.1.17 (안정적 호환성)
#
# 이 버전 조합은 Streamlit Cloud에서 검증된 가장 안정적인 조합입니다.
# proxies 매개변수 문제가 완전히 해결되어 있습니다.
# ================================================================

# ================================================================
# 시스템 요구사항 (Streamlit Cloud에서 자동 설치)
# ================================================================
# - tesseract-ocr (OCR 엔진) - Streamlit Cloud 지원
# - poppler-utils (PDF 처리) - Streamlit Cloud 지원

# ================================================================
# 설치 확인 방법
# ================================================================
# 1. 로컬 테스트: pip install -r requirements.txt
# 2. 모듈 import 확인: python test_integration.py  
# 3. Streamlit 실행: streamlit run app.py
# 4. 호환성 테스트: python -c "from langchain_community.embeddings import OpenAIEmbeddings; print('✅ OpenAI 호환성 확인')"
# ================================================================


